
#Connect to the DB
%load_ext sql
import csv, sqlite3
import pandas as pd
con = sqlite3.connect("my_data1.db")
cur = con.cursor()
%sql sqlite:///my_data1.db

df = pd.read_csv("https://cf-courses-data.s3.us.cloud-object-storage.appdomain.cloud/IBM-DS0321EN-SkillsNetwork/labs/module_2/data/Spacex.csv")
df.to_sql("SPACEXTBL", con, if_exists='replace', index=False,method="multi")

#Removing blank rows from table
%sql create table SPACEXTABLE as select * from SPACEXTBL where Date is not null

#Displayinh the names of the unique launch sitse in the Space Mission
%%sql SELECT DISTINCT "Launch_Site"
FROM SPACEXTABLE

#Displaying 5 records where launch sites begin with the string 'CCA'
%%sql SELECT *
FROM SPACEXTABLE
WHERE "Launch_Site" LIKE 'CCA%'
LIMIT 5

#Displaying unique booster versions where launch site starts with CCA
%%sql SELECT DISTINCT "Booster_Version"
FROM SPACEXTABLE
WHERE "Launch_Site" LIKE 'CCA%'
LIMIT 5

#Displaying the average payload mass carried by booster version F9 v1.1
%%sql SELECT AVG(PAYLOAD_MASS__KG_)
FROM SPACEXTABLE
WHERE Booster_Version LIKE 'F9 v1.1%'

#Displaying the date when the first succesful landing outcome in ground pad was achieved
%%sql SELECT MIN(DATE)
from SPACEXTABLE
WHERE Mission_Outcome = 'Success'

#Listing the names ofthe boostesr which have success in drone ship and have payload mass greater than 4000 bu less than 6000
%%sql SELECT *
from SPACEXTABLE
where Landing_Outcome = "Success (drone ship)" AND PAYLOAD_MASS__KG_ BETWEEN 4000 AND 6000

#Listing the otal number of succesful and failure mission outcomes
%%sql SELECT DISTINCT Mission_Outcome
FROM SPACEXTABLE

%%sql SELECT COUNT(Mission_Outcome)
FROM SPACEXTABLE
WHERE Mission_Outcome LIKE 'Success%'

%%sql SELECT COUNT(Mission_Outcome)
FROM SPACEXTABLE

#Listing the names of the booster_versions which have carried the maximum payload mass usin a subquery
%%sql SELECT Booster_version
FROM SPACEXTABLE
WHERE PAYLOAD_MASS__KG_ = (SELECT MAX(PAYLOAD_MASS__KG_) FROM SPACEXTABLE)

#Listing the records that display the month names, failure landing_outcomes in drone ship, booster versions, launch_site for year 2015
%%sql SELECT Date, substr(Date, 6, 2) as MONTH, Landing_Outcome, Booster_Version, Launch_Site
FROM SPACEXTABLE
WHERE Landing_Outcome LIKE "Failure (drone ship)" AND substr(Date, 1, 4) = '2015'

%%sql SELECT DISTINCT Landing_Outcome
FROM SPACEXTABLE

#Ranking the count of landing outcomes (such as Failure (drone ship) or Success (ground pad)) between the date 2010 - 06 - 04 and 2017 - 03 - 20 in descending order
%%sql SELECT Landing_Outcome, COUNT(Landing_Outcome)
FROM SPACEXTABLE
WHERE Date BETWEEN '2010-06-04' AND '2017-03-20'
GROUP BY Landing_Outcome
ORDER BY COUNT(Landing_Outcome) DESC
