#Import libraries
import pandas as pd
import numpy as np

#Pull data set
from js import fetch
import io

URL = 'https://cf-courses-data.s3.us.cloud-object-storage.appdomain.cloud/IBM-DS0321EN-SkillsNetwork/datasets/dataset_part_1.csv'
resp = await fetch(URL)
dataset_part_1_csv = io.BytesIO((await resp.arrayBuffer()).to_py())

#Load data set into df
df=pd.read_csv(dataset_part_1_csv)
df.head(10)

#Calculate percentage of missing values in each attribute
df.isnull().sum()/df.shape[0]*100

#Check variable type
df.dtypes

#Calculate the number of launches on each site
df['LaunchSite'].value_counts()

#Calculate the number and occurrence of each orbit
df['Orbit'].value_counts()

#Calculate the number and occurrence of missing outcome per orbit type
landing_outcomes = df['Outcome'].value_counts()
print(landing_outcomes)
for i,outcome in enumerate(landing_outcomes.keys()):
    print(i,outcome)

#Create a set of outcomes where the second stage did not land succesfully
bad_outcomes=set(landing_outcomes.keys()[[1,3,5,6,7]])
bad_outcomes

#Create a landing outcome label from Outcome column
#landing_class = 0 if bad_outcome
#landing_class = 1 otherwise
landing_class = []
for key,value in df["Outcome"].items():
     if value in bad_outcomes:
        landing_class.append(0)
     else:
        landing_class.append(1) 

df['Class']=landing_class
df[['Class']].head(8)

#Save file to CSV
df.to_csv("dataset_part_2.csv", index=False)
