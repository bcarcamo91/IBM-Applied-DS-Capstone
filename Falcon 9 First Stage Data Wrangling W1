#Import libraries
import pandas as pd
import numpy as np

#Data Analysis
from js import fetch
import io

URL = 'https://cf-courses-data.s3.us.cloud-object-storage.appdomain.cloud/IBM-DS0321EN-SkillsNetwork/datasets/dataset_part_1.csv'
resp = await fetch(URL)
dataset_part_1_csv = io.BytesIO((await resp.arrayBuffer()).to_py())

#Loading data set
df=pd.read_csv(dataset_part_1_csv)
df.head(10)

#Calculating percentage of missing values in each attribute
df.isnull().sum()/df.shape[0]*100

#Check the types of each variable
df.dtypes

#Calculating the number of launches on each site
df['LaunchSite'].value_counts()

#Calculating the number and occurrence of each orbit
df['Orbit'].value_counts()

#Calculating the number and occurrence of missiong outcome per orbit type
landing_outcomes = df['Outcome'].value_counts()
print(landing_outcomes)
for i,outcome in enumerate(landing_outcomes.keys()):
    print(i,outcome)

#Creating a set of outcomes where the second stage did not land succesfully
bad_outcomes=set(landing_outcomes.keys()[[1,3,5,6,7]])
bad_outcomes

#Creating a landing outcome label from Outcome column
#landing_class = 0 if bad_outcome
#landing_class = 1 otherwise
landing_class = []
for key,value in df["Outcome"].items():
     if value in bad_outcomes:
        landing_class.append(0)
     else:
        landing_class.append(1) 

df['Class']=landing_class
df[['Class']].head(8)

df.to_csv("dataset_part_2.csv", index=False)
